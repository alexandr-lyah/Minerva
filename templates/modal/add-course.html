<div id="add-course" class="modal hide fade">
  <div class="modal-header">
    <a class="close" data-dismiss="modal">&times;</a>
    <h3>Add Course</h3>
  </div>
  <div class="modal-body">
    <form id="form-add-course" action="" method="post" class="form-horizontal">
      {% csrf_token %}
      {% for field in form %}
      <div id="form-add-course-{{ field.html_name }}" class="control-group">
        <label for="id_{{ field.name }}" class="control-label"> {{ field.label }} </label>
        <div class="controls">
          {{ field }}<span class="help-inline"></span>
        </div>
      </div>
      {% endfor %} <div id="form-add-course-error"></div>
    </form>
  </div>
  <div class="modal-footer">
    <a id="add-course-button" class="btn btn-primary" data-loading-text="Adding..." onclick="form_add_course();">Add Course</a>
    <a href="#" class="btn" data-dismiss="modal">Close</a>
  </div>
</div>

<script type="text/javascript" charset="utf-8">
  function form_add_course() {
    var form_id = 'form-add-course';
    form_data = $('#' + form_id).serializeObject(true);
    $('#add-course-button').button('loading');
    Dajaxice.course.form_add_course(Dajax.process, {
      'form_data' : form_data,
      'form_id' : form_id
    });
  }

  function form_add_course_callback(data) {
    $('#add-course-button').button('reset');
    if(data.status == 'OK') {
      $('#add-course').modal('hide');
      window.location.reload();
    }
  }

  $(document).ready(function() {
    $('#form-add-course input[name="title"]').autocomplete({
      source : '/source_course/',
      minLength : 2,
      autoFocus : true,
      delay : 100,
      focus : function(event, ui) {
        return false;
      },
      select : function(event, ui) {
        $(this).val(ui.item.label);
        $('#form-add-course input[name="course"]').attr('value', ui.item.value);
        return false;
      },
    });
  });
</script>
{% extends "base.html" %}

{% load base_extra %}
{% load webdesign %}

{% block title %}Mynodo - People{% endblock %}

{% block content %}
<div class="page-header">
  <div class="row-fluid">
    <div class="span1">
      <div class="thumbnail"><img src="http://placehold.it/100x100" alt="" />
      </div>
    </div>
    <div class="span11">
      <h1>{{ current_user.get_full_name }}</h1>
      {% if profile.degree %} <h6>{{ profile.get_degree_display }} {{ profile.get_role_display }} from {{ profile.institute }}</h6>
      {% else %} <h6>{{ profile.get_role_display }} from {{ profile.institute }}</h6>
      {% endif %} <div class="vertical-space"></div>
      <div class="row-fluid">
        <ul class="thumbnails">
          {% for b in badges %}
          <li>
            <a class="thumbnail" rel="popover" data-content="Obtained: {{ b.obtained }}<br />EXP: {{ b.exp }}<br />" data-original-title="{{ b.badge }}"> <img src="http://placehold.it/30x30" alt="" /> </a>
          </li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
</div>
<div class="row-fluid">
  <div class="span6">
    <div class="row-fluid">
      <div class="span6">
        {% with specializations=profile.specialization_set %} <h3>Specialization{{ specializations.count|pluralize }}:</h3>
        {% if specializations.count == 0 %} <h6>No Specialization Yet!</h6>
        {% endif %}
        {% for specialization in specializations.all %} <h6>{{ specialization.name }}</h6>
        {% endfor %} <a href="#"><strong>Add Specialization</strong></a>
        {% endwith %}
      </div>
      <div class="span6">
        {% with skills=profile.skill_set %} <h3>Skill{{ skills.count|pluralize }}:</h3>
        {% if skills.count == 0 %} <h6>No Skill Yet!</h6>
        {% endif %}
        {% for skill in skills.all %} <h6>{{ skill.name }}</h6>
        {% endfor %} <a href="#"><strong>Add Skill</strong></a>
        {% endwith %}
      </div>
    </div>
    <div class="vertical-space"></div>
    <div class="row-fluid">
      {% if profile.role = 'S' %} <h3>Encouragement{{ encouragements.count|pluralize }}:</h3>
      <div class="vertical-space"></div>
      {% if encouragements.count == 0 %} <h6>No Encouragement Yet!</h6>
      {% endif %}
      {% if current_user != user %}
      <div class="vertical-space"></div>
      <a data-toggle="modal" href="#encouragement" class="btn btn-warning"><i class="icon-pencil icon-white"></i> Write Encouragement </a>
      <div class="vertical-space"></div>
      <div class="vertical-space"></div>
      {% endif %}
      {% for encouragement in encouragements %}
      <blockquote>
        <h6>{{ encouragement.sent_time }}</h6>
        <p><i>"{{ encouragement.message }}"</i></p><small>{% if encouragement.anonymous %} Anonymous {% else %} <a href="{% url people %}{{ encouragement.person_from.user.username }}">{{ encouragement.person_from }}</a>{% endif %}</small>
      </blockquote>
      {% endfor %}
      {% endif %}
    </div>
  </div><!--/span-->
  <div class="span6">
    <div class="row-fluid">
      <form class="form-search">
        <input type="text" class="input-large">
        <button type="submit" class="btn">
          Search Anyone
        </button>
      </form>
      <h3>Related:</h3>
      <div class="vertical-space"></div>
      {% for p in related %}
      <div class="well">
        <h5><a href="{% url people %}{{ p.user.username }}">{{ p }}</a></h5>
      </div>
      {% endfor %}
    </div>
  </div><!--/span-->
</div>
<div id="encouragement" class="modal hide fade" style="display: none; ">
  <div class="modal-header">
    <a class="close" data-dismiss="modal">Ã—</a>
    <h3>Write An Encouragement</h3>
  </div>
  <div class="modal-body">
    <form id="form-encouragement" action="" method="post" class="form-vertical">
      {% csrf_token %}
      {% encouragement_form %}
      {% for field in encouragement_form %}
      <div id="form-encouragement-{{ field.html_name }}" class="control-group">
        {{ field.label_tag }}
        <div class="controls">
          {{ field }}<span class="help-inline"></span>
        </div>
      </div>
      {% endfor %} <div id="form-encouragement-error"></div>
    </form>
  </div>
  <div class="modal-footer">
    <a id="post-encouragement-button" class="btn btn-primary" data-loading-text="Posting..." onclick="form_encouragement();">Post</a>
    <a href="#" class="btn" data-dismiss="modal">Close</a>
  </div>
</div>
<script type="text/javascript" charset="utf-8">
	function form_encouragement() {
		var form_id = 'form-encouragement';
		// Set hidden field
		$('#form-encouragement input[name="person_to"]').attr('value', '{{ current_user.id }}');
		form_data = $('#' + form_id).serializeObject(true);
		$('#post-encouragement-button').button('loading');
		Dajaxice.Minerva.account.form_encouragement(Dajax.process, {
			'form_data' : form_data,
			'form_id' : form_id
		});
	}

	function form_encouragement_callback(data) {
		$('#post-encouragement-button').button('reset');
		if(data.status == 'OK') {
			$('#encouragement').modal('hide');
			window.location.reload();
		}
	}
</script>
{% endblock %} 